---
title: "Analysis"
author: "Jumoke Ajakaiye and Ricardo David Barragan Martinez"
date: "5/23/2021"
output: html_document
---

# Animals slaughtered for meat

## A glance at the data

```{r include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(janitor)
```

```{r load the slaughtered data set, include=FALSE}
global_meat_production <- data.frame( read_csv("archive (5)/global-meat-production.csv"))
```

```{r}
head(global_meat_production)
```


```{r summary of data animals slaughtered DS, echo=FALSE}
#Summary of data set
summary(global_meat_production)
```

## Observing the data with graphs before cleaning

```{r plot wiht by year and turkey,echo=FALSE}
#added the title, subtitle, ylab, and caption)

ggplot(global_meat_production, aes(x = Year, y =global_meat_production$`Livestock.Primary...Meat..Total...1765...Production...5510...tonnes..tonnes.`)) +  
  labs(title = "World Meat Production Datasets 1961 - 2018", subtitle = "Global Meat Production", caption = "Data from Food and Agriculture Organization")+
  ylab("Livestock Primary")+
  geom_line(aes(color = Year), size = 1) + theme_minimal()
```

### Analysing the NA values

```{r observing NA values, echo=FALSE}
#Observing data with NA values
global_meat_production[rowSums(is.na(global_meat_production)) > 0,]
```

Observing the NA values with NA values in the code column

```{r observing data with NA values in the values column,echo=FALSE}
#Observing data with NA values in the code column
global_meat_production[is.na(global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`), ]
```

Cleaning the columns and renaming 

```{r}
#Formatted the columns titles to lowercase

global_meat_production <- clean_names(global_meat_production)
```


```{r}
#Used the pipe operator to rename the columns

global_meat_production <- global_meat_production %>% 
  rename(country = entity,
         country_code = code, 
         livestock_primary = `livestock_primary_meat_total_1765_production_5510_tonnes_tonnes`)
```

Cleaning the rows without code.


```{r Cleaning codes for country,echo=FALSE}
#Because the code does not have codes for the countries, it is necessary to erase those rows.
#Delete columns without code (Only rows that are countries)

# We shouldn't delete the rows with NA since the rows have data within the other columns.

global_meat_production <- global_meat_production[!is.na.data.frame(global_meat_production$country_code)]
```

## Data of animals slaughtered after cleaning

Head of animals slaughtered after cleaning

```{r head of animals slaughtered after cleaning, echo=FALSE}
#head of data set
head(global_meat_production)
```

Summary of animals slaughtered after cleaning

```{r summary of animals slaughtered after cleaning,echo=FALSE}
#Summary of data set
summary(global_meat_production)
```

```{r}
head(arrange(global_meat_production,desc(global_meat_production$livestock_primary)),n = 20)
```


```{r}

# Look at the code below line 103, the code filtered OWID_WRL
# The code on line 99, run an error on my end

global_meat_production <- global_meat_production[global_meat_production$country_code != "OWID_WRL"]
```

# New dataframe

```{r}

# Filtered OWID_WRL
# Created new dataframe to run the following codes below.
# We can also edit it back to the original dataframe
# Once we figure out why the code on line 99 didn't work for me

global_mp <- filter(global_meat_production, country_code != "OWID_WRL")
```


```{r}
head(arrange(global_mp,desc(global_mp$livestock_primary,n = 50)))
```

Observing the data with graphs after cleaning

```{r plot wiht by year and turkey after cleaning,echo=FALSE}
#global_mp dataframe
#added ylab,xlab, title, subtitle, and caption) 

ggplot(global_mp, aes(x = year, y = `livestock_primary`)) + 
  ylab("Livestock Primary")+ xlab("Year")+
  labs(title = "World Meat Production Datasets 1961 - 2018", subtitle = "Global Meat Production", caption = "Data from Food and Agriculture Organization")+ 
  geom_line(aes(color = year), size = 1) +
  theme_minimal()
```


```{r plot wiht by year and turkey after cleaning,echo=FALSE}
#global_mp dataframe
#added xlab, title, subtitle, and caption) 

ggplot(global_mp) +
  aes(x = `livestock_primary`) +
  labs(title = "World Meat Production Datasets 1961 - 2018", subtitle = "Global Meat Production", caption = "Data from Food and Agriculture Organization")+
  xlab("Livestock Primary")+
  geom_histogram(bins = 30L, fill = "#0c4c8a") +
  theme_minimal()
```

```{r}
#global_mp
#edit Category to category

summ_prod_by_country <- aggregate(global_mp$livestock_primary, by = list(category = global_mp$country_code), FUN=sum)

summ_prod_by_country[order(-summ_prod_by_country$x),]
 
```
```{r}
#added title, xlab, subtitle, and caption

ggplot(summ_prod_by_country) +
  aes(x = "", y = x ) +
  xlab("Total Production per Country") +
  labs(title = "World Meat Production Datasets 1961 - 2018", subtitle = "Meat Production Total per Country", caption = "Data from Food and Agriculture Organization")+ geom_boxplot(fill = "#0c4c8a") +
  theme_minimal()
```
```{r}

top <- summ_prod_by_country %>%
    arrange(desc(x)) %>%
    slice(1:10)
```

```{r}
#edit Category to category

ggplot(data=top, aes(x=category, y=x,fill=category)) +
    geom_bar(stat="identity") +
    geom_text(aes(label=round(x/1000000)), vjust=1.6, color="black", size=3.5) + 
    theme_minimal() + 
    theme(axis.text.y = element_blank()) +
    ggtitle("Top 10 countries with more production from 1960 to 2018") +
    xlab("Countries") +
    ylab("Production in Mio.") + 
    guides(fill=FALSE)
```

