---
title: "Analysis"
author: "Jumoke Ajakaiye and Ricardo David Barragan Martinez"
date: "5/23/2021"
output: html_document
---

# Animals slaughtered for meat

## A glance to the data

```{r include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
```

```{r load the slaughtered data set, include=FALSE}
global_meat_production <- read_csv("archive (5)/global-meat-production.csv")
```

```{r}
head(global_meat_production)
```


```{r summary of data animals slaughtered DS, echo=FALSE}
#Summary of data set
summary(global_meat_production)
```

## Observing the data with graphs before cleaning

```{r plot wiht by year and turkey,echo=FALSE}
ggplot(global_meat_production, aes(x = Year, y = global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`)) + 
  geom_line(aes(color = Year), size = 1) +
  theme_minimal()
```

### Analysing the NA values

```{r observing NA values, echo=FALSE}
#Observing data with NA values
global_meat_production[rowSums(is.na(global_meat_production)) > 0, ]
```

Observing the NA values with NA values in the code column

```{r observing data with NA values in the values column,echo=FALSE}
#Observing data with NA values in the code column
global_meat_production[is.na(global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`), ]
```

Cleaning the rows without code.
```{r Cleaning codes for continents,echo=FALSE}
#Because the code does not have codes for the continents, it is necessary to erase those rows.
#Delete columns without code (Only rows that are continents)
global_meat_production <- global_meat_production[!is.na(global_meat_production$Code), ]
```


## Data of animals slaughtered after cleaning

Head of animals slaughtered after cleaning

```{r head of animals slaughtered after cleaning, echo=FALSE}
#head of data set
head(global_meat_production)
```

Summary of animals slaughtered after cleaning

```{r summary of animals slaughtered after cleaning,echo=FALSE}
#Summary of data set
summary(global_meat_production)
```

```{r}
head(arrange(global_meat_production,desc(global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`)),n = 20)
```

```{r}
global_meat_production <- global_meat_production[global_meat_production$Code != "OWID_WRL", ]
```

```{r}
head(arrange(global_meat_production,desc(global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`)),n = 50)
```

Observing the data with graphs after cleaning

```{r plot wiht by year and turkey after cleaning,echo=FALSE}
ggplot(global_meat_production, aes(x = Year, y = global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`)) + 
  geom_line(aes(color = Year), size = 1) +
  theme_minimal()
```


```{r plot wiht by year and turkey after cleaning,echo=FALSE}
ggplot(global_meat_production) +
  aes(x = global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`) +
  geom_histogram(bins = 30L, fill = "#0c4c8a") +
  theme_minimal()

```

```{r}
summ_prod_by_country <- aggregate(global_meat_production$`Livestock Primary - Meat, Total - 1765 - Production - 5510 - tonnes (tonnes)`, by=list(Category=global_meat_production$Code), FUN=sum)

summ_prod_by_country[order(-summ_prod_by_country$x),]
```
```{r}
ggplot(summ_prod_by_country) +
  aes(x = "", y = summ_prod_by_country$x) +
  geom_boxplot(fill = "#0c4c8a") +
  theme_minimal()
```
```{r}

top <- summ_prod_by_country %>%
    arrange(desc(x)) %>%
    slice(1:10)
```

```{r}
ggplot(data=top, aes(x=Category, y=x,fill=Category)) +
    geom_bar(stat="identity") +
    geom_text(aes(label=round(x/1000000)), vjust=1.6, color="black", size=3.5) + 
    theme_minimal() + 
    theme(axis.text.y = element_blank()) +
    ggtitle("Top 10 countries with more production from 1960 to 2018") +
    xlab("Countries") +
    ylab("Production in Mio.") + 
    guides(fill=FALSE)
```

